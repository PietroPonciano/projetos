import random
import time
import re
import json

class AssistenteDeBemEstar:
    def __init__(self):
        self.historico = []
        self.memoria = {}  # Para armazenar dados a longo prazo
        self.lista_palavras_positivas = ['Ã³timo', 'excelente', 'muito bom', 'feliz', 'alegre', 'animado']
        self.lista_palavras_negativas = ['pÃ©ssimo', 'triste', 'horrÃ­vel', 'muito ruim', 'cansado', 'desanimado']
        self.lista_palavras_neutras = ['ok', 'normal', 'mais ou menos', 'poderia ser melhor']
        self.lista_intensificador = ['muito', 'bastante', 'extremamente']
        self.lista_negacao = ['nÃ£o', 'nao', 'nunca', 'nÃ£o sei', 'nÃ£o tenho certeza']
        self.respostas_positivas = [
            "Que bom saber disso! ğŸ˜Š Continue assim! ",
            "Seu dia parece Ã³timo! ğŸŒŸ Fico muito feliz por vocÃª! ",
            "Parece que as coisas estÃ£o indo bem. Que maravilha! ğŸŒˆ"
        ]
        self.respostas_neutras = [
            "Parece que foi um dia equilibrado. ğŸ˜Š",
            "Nem tÃ£o bom, nem tÃ£o ruim, nÃ©? Espero que vocÃª tenha algo bom planejado para amanhÃ£. ğŸŒ",
            "Que tal fazer algo divertido para relaxar? ğŸ€"
        ]
        self.respostas_negativas = [
            "Sinto muito por isso. ğŸ˜” Lembre-se, dias ruins passam!",
            "Tudo bem sentir-se assim. AmanhÃ£ pode ser um novo comeÃ§o. ğŸ’ª",
            "ForÃ§a! Estou aqui para te ouvir sempre que precisar. ğŸŒ»"
        ]
        self.contexto_usuario = {}  # DicionÃ¡rio para armazenar dados personalizados
        
        self.algo_mais = [
            "Posso ajudar em algo mais?",
            "Precisa de mais alguma coisa?"
            
            ]

    def saudar_usuario(self):
        print("OlÃ¡! Eu sou sua assistente de bem-estar. ğŸ˜Š")
        print("Estou aqui para ouvir, ajudar e acompanhar como vocÃª estÃ¡ se sentindo.")
        time.sleep(2)

    def analisar_sentimento(self, resposta):
        resposta = resposta.lower()
        score = 0
        for frase in self.lista_palavras_positivas:
            if frase in resposta:
                score += 2
        for frase in self.lista_palavras_negativas:
            if frase in resposta:
                score -= 2
        palavras = resposta.split()
        for i, palavra in enumerate(palavras):
            if palavra in self.lista_intensificador:
                if i + 1 < len(palavras):
                    proxima_palavra = palavras[i + 1]
                    if proxima_palavra in self.lista_palavras_positivas:
                        score += 1
                    elif proxima_palavra in self.lista_palavras_negativas:
                        score -= 1
            elif palavra in self.lista_palavras_positivas:
                score += 1
            elif palavra in self.lista_palavras_negativas:
                score -= 1
            elif palavra in self.lista_palavras_neutras:
                score += 0
        return score

    def oferecer_resposta(self, score):
        if score > 2:
            return random.choice(self.respostas_positivas)
        elif score >= 0:
            return random.choice(self.respostas_neutras)
        else:
            return random.choice(self.respostas_negativas)

    def oferecer_dicas(self, score):
        print("\nAqui estÃ£o algumas sugestÃµes para vocÃª:")
        if score > 2:
            print("- Aproveite o momento positivo! FaÃ§a algo que vocÃª ama. ğŸ‰")
            print("- OuÃ§a uma mÃºsica alegre para aumentar ainda mais sua energia! ğŸ¶")
        elif score >= 0:
            print("- Experimente fazer algo que te relaxe, como assistir a um filme ou ler um livro. ğŸ“–")
            print("- Tire um tempo para refletir sobre coisas boas do dia. ğŸŒ¼")
        else:
            print("- Experimente tÃ©cnicas de mindfulness ou respiraÃ§Ã£o para aliviar o estresse. ğŸ§˜")
            print("- Converse com alguÃ©m de confianÃ§a. Pode fazer bem compartilhar. ğŸ’¬")

    def registrar_memoria(self, chave, valor):
        self.memoria[chave] = valor
        print(f"\nMemorizando: {chave} = {valor}")

    def carregar_memoria(self):
        if self.memoria:
            print("\nCarregando sua memÃ³ria de interaÃ§Ãµes passadas...")
            for chave, valor in self.memoria.items():
                print(f"{chave}: {valor}")
        else:
            print("\nAinda nÃ£o temos muitas memÃ³rias, vamos construir juntos!")

    def ajustar_respostas_personalizadas(self):
        # Personaliza as respostas com base nas preferÃªncias do usuÃ¡rio
        nome_usuario = self.contexto_usuario.get('nome', 'UsuÃ¡rio')
        print(f"\n{nome_usuario}, vou comeÃ§ar a adaptar minhas respostas de acordo com suas preferÃªncias!")

    def calcular_score(self, resposta):
        score = self.analisar_sentimento(resposta)
        print("\nAnalisando sua resposta...")
        time.sleep(2)
        print(f"Seu texto possui um score de {score}.")
        print(self.oferecer_resposta(score))

        while score < 2:
            resposta_usuario = input("\nParece que vocÃª tem mais para compartilhar. ğŸ“ Quer continuar? Me conte mais sobre seu dia (Digite 'nÃ£o' para encerrar): ")
            if any(neg in resposta_usuario.lower() for neg in self.lista_negacao):
                print("Tudo bem! Sempre estarei aqui se precisar. ğŸŒŸ")
                break
            score = self.analisar_sentimento(resposta_usuario)
            print(self.oferecer_resposta(score))
            self.registrar_memoria('Ãšltima resposta', resposta_usuario)

        resposta_dicas = input("\nGostaria de receber algumas dicas? (Digite 'sim' para dicas ou 'nÃ£o' para encerrar): ")
        if resposta_dicas.lower() == 'sim':
            self.oferecer_dicas(score)
        else:
            print("Tudo bem! Fico feliz por poder conversar com vocÃª. ğŸŒŸ")

    def iniciar(self):
        self.saudar_usuario()
        nome = input("\nQual Ã© o seu nome? ")
        self.contexto_usuario['nome'] = nome
        resposta = input("\nComo estÃ¡ o seu dia hoje? ")
        self.calcular_score(resposta)
        self.carregar_memoria()
        self.ajustar_respostas_personalizadas()
        print("\nObrigada por conversar comigo. Estou aqui sempre que precisar. ğŸŒŸ")

assistente = AssistenteDeBemEstar()
assistente.iniciar()
